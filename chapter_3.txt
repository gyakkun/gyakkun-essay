第三章 总体设计

3.1 系统结构

如2.4中所述, UNIT3D按照标准的Laravel项目组织文件。根据开发需要, 笔者需要增删修改的主要有`/app/Http/Controllers/, /app/Http/Controllers/API/, /app/Models/, /database/migrations/, /resources/views/, /resources/lang/`, 分别对应投票、增添新字段所应修改的控制器部分, 数据结构模型部分, 数据库表迁移部分, 资源的视图部分, 以及本地化的语言词汇对照部分。

[图 PhpStorm中的目录结构, 突出显示上面提到的部分]


3.2 功能增删与调整

3.2.1 中文本地化

未经修改的原始开源版本有开发者负责将英语的词汇进行机器翻译, 使之能够勉强本地化使用。然而作为母语是中文的用户, 机器翻译并不能满足笔者的要求。为此, 笔者修改了`/resources/views/, /resources/lang/`中的内容。

原版中已经有大量硬编码进视图的英语词汇。笔者的工作是将其一一剔除替换成可被取引用的`@lang('lang.var')`的形式。然后针对`/resources/lang/`中已有机器翻译的词汇, 进行一一校对、润色。

{ //感觉应该放到第四章???

[图 一份git diff式的源码前后对比, 突出从原始英语单词到`@lang('lang.var')`的部分]

然后针对英语转中文的翻译部分, 笔者曾经修过实用口译这门课程, 对快速高效的翻译颇有心得。经过一番重新翻译、修改、润色, 最终得到了令人满意的中文用户界面。

[图 对比前后用户界面的语言部分]

}


3.2.2 数据表字段调整

因为NexusPHP中有比较关键的字段, 如种子描述的副标题, 再UNIT3D中并没有对应的字段, 所以为了接下来的迁移工作, 必须要对UNIT3D的数据表进行字段的调整。

笔者主要的工作是在`/database/migrations/`目录中增加数据库改动迁移脚本, 同时要编写回溯的脚本, 以便于数据库的回滚操作。

3.2.3 迁移NexusPHP数据表

3.2.4 标签调整

3.2.5 实现投票功能

3.2.6 实现IP地址记录功能















